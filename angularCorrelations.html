<html>
    <head>
        <title>GRIFFIN Angular Correlations</title>
        <script src='scripts/HTMLImports.min.js' type="text/javascript"></script>
        <script src='scripts/mustache.js' type="text/javascript"></script>
        <script src='scripts/easeljs-0.7.0.min.js' type="text/javascript"></script>
        <script src='scripts/dygraphs.1.1.1.min.js' type="text/javascript"></script>
        <script src='scripts/regression.min.js' type="text/javascript"></script>
        <script src='scripts/gammaSpectrum.js' type="text/javascript"></script>
        <script src='scripts/fitit.js' type="text/javascript"></script>
        <script src="scripts/jquery1-11-3.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <script src="scripts/bootstrap3-3-5.min.js"></script>

        <script src='scripts/helpers.js' type="text/javascript"></script>
        <script src='scripts/calibrationTools.js' type="text/javascript"></script>
        <script src='scripts/angularCorrelations.js' type="text/javascript"></script>
        <link rel="stylesheet" type="text/css" href="css/custom.css"/>

        <!--HTML imports-->
        <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
        <link id='header' rel="import" href="templates/header/header.html">
        <link id='angularCorrelationsReport' rel="import" href="templates/angularCorrelations/angularCorrelationsReport.html">
        <link id='angularCorrelationsTable' rel="import" href="templates/angularCorrelations/angularCorrelationsReportTable.html">
        <link id='plotGrid' rel="import" href="templates/plotGrid/plotGrid.html">
        <link id='plotControl' rel="import" href="templates/plotControl/plotControl.html">
        <link id='plotListLite' rel="import" href="templates/plotList/plotListLite.html">
        <link id='dataplot' rel="import" href="templates/dataplot/dataplot.html">
        <link id='footer' rel="import" href="templates/footer/footer.html">
    </head>

    <body>
      <div id='head'></div>

      <div id='histo-list-container' class='container-fluid'>
        <div id='histo-list-server-div' class='col-md-3'></div>
        <div id='histo-list-directory-div' class='col-md-6'>Histogram Directory: </div>
        <div id='histo-list-menu-div' class='col-md-3'></div>
      </div>

<!--
      <div id='progressDiv' class="progress" width=100%>
<div id='progress' class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">Initializing App...</div>
      </div>
    -->
      <div id='progressDiv' class="progress" width=100%>
          <div id="progress" class="progress-bar
              progress-bar-success progress-bar-striped active"
              role="progressbar"
              aria-valuemin="0"
              aria-valuemax="100"
              [attr.aria-valuenow]="dataStore.ProgressValue"
              [style.width.%]="dataStore.ProgressValue">
              {{dataStore.ProgressValue}}% Complete
          </div>
      </div>


      <!--helpful hints-->
      <div class='col-md-6'>
        <div id='downloadMessage' class="alert alert-warning" role="alert">
          <span class="glyphicon glyphicon-check" aria-hidden="true"></span>
          Initializing. Spectra are downloading, please wait...
        </div>

        <div id='readyMessage' class="alert alert-warning hidden" role="alert">
          <span class="glyphicon glyphicon-check" aria-hidden="true"></span>
          Ready to make gamma-gamma angular correlations. Please enter the two peak energies.
        </div>

        <div id='projectionsMessage' class="alert alert-warning hidden" role="alert">
          <span class="glyphicon glyphicon-check" aria-hidden="true"></span>
          Projecting the angular correlation matrices and fitting peaks.
        </div>

        <div id='reviewMessage' class="alert alert-warning hidden" role="alert">
          <span class="glyphicon glyphicon-check" aria-hidden="true"></span>
          Review the results in the table below, and refit any troublesome peaks one at a time.
        </div>
      </div>

            <!--user input-->
            <div class='col-md-12'>
                    <div id='gateInputsDiv' class="input-group">
                      <span class='input-group-addon'>Gamma-ray energies: </span>
                      <input id="gamma1Input" value="1173" min="0" max="4095" type="number" class='black-text' disabled=true></input>
                      <input id="gamma2Input" value="1332" min="0" max="4095" type="number" class='black-text' disabled=true></input>
                    </div>
                    <button type="button" class="btn btn-default btn-sm" id='ggAngCorrProject' engaged='0' disabled=true>
                      <span id='gateBadge' class="glyphicon glyphicon-equalizer" aria-hidden="true">Let's see it!</span>
                    </button>
            </div>

      <div class='section-wrapper'>
        <!--Spectrum Plotting-->
        <div id='plotRegion' class='sectionWrapper'>
          <div id='plotWrap' class='col-md-9 plotRegion item'>
            <div id='plottingGrid'></div>
            <div class='col-md-8' id='plotCtrl'></div>
            <div class='sectionWrapper refitButtons'>
              <div class='col-md-12'>
                <button type="button" class="btn btn-default btn-lg" id='refitPeakButton' engaged='0'>
                  <span id='refitPeakBadge' class="glyphicon glyphicon-equalizer" aria-hidden="true"></span>
                  <span id='loText'>Refit a Peak</span>
                </button>
              </div>
            </div>
          </div>
          <div class='col-md-2 item'>
            <div id='plotList' style='overflow-y:scroll; height:400px;'></div>
          </div>
        </div>

        <!--Table of calculations and results-->
        <div id='angularCorrelationsReportWrap' class='sectionWrapper hidden'></div>

        <!--Efficiency curve Plotting-->
        <div id='graphSection' class='sectionWrapper'>
          <div id='angularCorrelationsPlotWrap' class='col-md-12'>
  	        <div id='dataPlot0' class='col-md-12'></div>
          </div>
        </div>

      </div>

  </div>

        <div id='foot'></div>

        <script>
            window.addEventListener('HTMLImportsLoaded', function(e) {

                dataStore._plotGrid = new plotGrid('plottingGrid');
                dataStore._plotControl = new plotControl('plotCtrl', 'horizontal');
                dataStore._dataplot[0] = new dataplot('dataPlot0',0);

                dataStore.templates = prepareTemplates(['header', 'angularCorrelationsReport', 'angularCorrelationsTable', 'plotGrid', 'plotControl', 'plotListLite', 'dataplot', 'footer']);

                setupHeader('head', 'Angular Correlations');
                dataStore._plotGrid.setup();
                dataStore._plotControl.setup();
                //set up spectrum cell
                dataStore._plotGrid.manageCellCreation(null, dataStore.plots[0]);
                dataStore._dataplot[0].setup(0);
                setupFooter('foot');

                //don't want additional plots in this app
          deleteNode('plottingGridnewPlotButton');

          $(function () {
                    $('[data-toggle="tooltip"]').tooltip()
                });

                // Plug in the onchange functions
                document.getElementById('gamma1Input').onchange = function(){
                  dataStore.gg_ang_corr_gamma1E = this.value;
                }.bind(document.getElementById('gamma1Input'));
                document.getElementById('gamma2Input').onchange = function(){
                  dataStore.gg_ang_corr_gamma2E = this.value;
                }.bind(document.getElementById('gamma2Input'));
                document.getElementById('ggAngCorrProject').onclick = function(){
                 projectAngularCorrelations();
               };

            // Launch the setup and histogram downloading
            initializeAngularCorrelations();
            });

        // Trigger the initial loading sequence
        onloadInitialSetup();
        </script>
    </body>
</html>
